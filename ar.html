<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AR Scene</title>
    <script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script>
    <script src="https://aframe.io/releases/1.3.0/aframe-ar.js"></script>
    <script src="https://unpkg.com/three@0.139.2/build/three.min.js"></script>
</head>
<body style="margin: 0; overflow: hidden;">
    <a-scene embedded arjs>
        <!-- L'objet est positionné à une position locale fixe -->
        <a-entity
            id="ar-model"
            gltf-model="url(test.glb)"
            position="0 0 0"
            scale="1 1 1">
        </a-entity>

        <!-- La caméra AR est ajoutée pour la vue en AR -->
        <a-camera></a-camera>
    </a-scene>

    <script>
        // Fonction pour convertir les coordonnées GPS en coordonnées locales (simplifiée)
        function gpsToLocal(lat, lng) {
            // Cette fonction dépendra de votre système de coordonnées locales.
            // Ici, nous utilisons une conversion simple pour démonstration.
            return {
                x: (lng - 10.483158) * 1000, // Conversion simplifiée, à ajuster
                y: 0, // Pas de changement en Y
                z: (lat - 32.876907) * 1000  // Conversion simplifiée, à ajuster
            };
        }

        // Récupérer les valeurs stockées depuis la première page
        const latitude = parseFloat(localStorage.getItem('latitude'));
        const longitude = parseFloat(localStorage.getItem('longitude'));
        const scale = localStorage.getItem('scale');
        const localPosition = JSON.parse(localStorage.getItem('localPosition'));

        // Convertir les coordonnées GPS en coordonnées locales
        const localCoords = gpsToLocal(latitude, longitude);

        // Appliquer les paramètres à l'objet AR
        const arModel = document.getElementById('ar-model');
        arModel.setAttribute('position', `${localCoords.x + localPosition.x} ${localPosition.y} ${localCoords.z + localPosition.z}`);
        arModel.setAttribute('scale', `${scale} ${scale} ${scale}`);
    </script>
</body>
</html>
