<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AR Skull Model - Matrix Control</title>
    <script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script>
    <script src="https://aframe.io/releases/1.3.0/aframe-ar.js"></script>
    <style>
        body { 
            margin: 0; 
            font-family: Arial, sans-serif; 
            background-color: #f0f0f0; 
            color: #333; 
        }
        a-scene { 
            width: 100vw; 
            height: 100vh; 
        }
        #button-container {
            position: absolute; 
            top: 10px; 
            left: 10px;
            z-index: 1; 
            display: grid; 
            grid-template-columns: repeat(3, 1fr);
            gap: 5px;
        }
        #matrix-display {
            position: absolute;
            top: 10px; 
            right: 10px; 
            z-index: 1;
            background: rgba(255, 255, 255, 0.8); 
            color: black;
            padding: 10px; 
            font-size: 14px;
            border-radius: 5px; 
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            width: 300px; 
            overflow-wrap: break-word;
            transition: background 0.3s;
        }
        #matrix-display:hover {
            background: rgba(255, 255, 255, 1);
        }
        button {
            padding: 10px;
            font-size: 16px;
            cursor: pointer;
            border: none;
            background-color: #007BFF;
            color: white;
            border-radius: 5px;
            transition: background 0.3s;
        }
        button:hover {
            background-color: #0056b3;
        }
    </style>
</head>
<body>
    <a-scene embedded arjs="sourceType: webcam; debugUIEnabled: false;">
        <!-- Caméra AR -->
        <a-camera gps-camera rotation-reader></a-camera>

        <!-- Modèle 3D avec position initiale définie par la matrice -->
        <a-entity
            id="skull-model"
            obj-model="obj: url(12140_Skull_v3_L2.obj); mtl: url(12140_Skull_v3_L2.mtl)"
            position="0 -0.5 -3"
            scale="0.04 0.04 0.04"  
            rotation="0 0 0" 
            gps-entity-place="latitude: 32.876907; longitude: 10.483158;">
        </a-entity>

        <!-- Repère de coordonnées -->
        <a-entity id="coordinate-system" position="0 0 0">
            <!-- Axe X -->
            <a-cylinder position="0.5 0 0" height="0.02" radius="0.02" color="red" rotation="90 0 0"></a-cylinder>
            <a-entity position="0.5 0 0.1" text="value: X; align: center; color: red;"></a-entity> <!-- Label X -->
            
            <!-- Axe Y -->
            <a-cylinder position="0 0.5 0" height="0.02" radius="0.02" color="green" rotation="0 0 0"></a-cylinder>
            <a-entity position="0 0.5 0.1" text="value: Y; align: center; color: green;"></a-entity> <!-- Label Y -->
            
            <!-- Axe Z -->
            <a-cylinder position="0 0 0.5" height="0.02" radius="0.02" color="blue" rotation="0 90 0"></a-cylinder>
            <a-entity position="0 0 0.6" text="value: Z; align: center; color: blue;"></a-entity> <!-- Label Z -->
        </a-entity>

        <!-- Zone de texte pour afficher la matrice, initialisée avec les valeurs données -->
        <div id="matrix-display">Matrice du modèle :<br>0.06 0.00 0.00 0.00<br>0.00 0.01 -0.06 0.00<br>0.00 0.06 0.01 0.00<br>0.00 1.10 -3.00 1.00</div>
    </a-scene>

    <!-- Boutons de contrôle -->
    <div id="button-container">
        <button onclick="moveModel(0.1, 0, 0)">→ Droite</button>
        <button onclick="moveModel(-0.1, 0, 0)">← Gauche</button>
        <button onclick="moveModel(0, 0.1, 0)">↑ Monter</button>
        <button onclick="moveModel(0, -0.1, 0)">↓ Descendre</button>
        <button onclick="rotateModel(10, 0, 0)">⟳ Tourner X</button>
        <button onclick="rotateModel(-10, 0, 0)">⟲ Tourner -X</button>
        <button onclick="rotateModel(0, 10, 0)">⟳ Tourner Y</button>
        <button onclick="rotateModel(0, -10, 0)">⟲ Tourner -Y</button>
        <button onclick="rotateModel(0, 0, 10)">⟳ Tourner Z</button>
        <button onclick="rotateModel(0, 0, -10)">⟲ Tourner -Z</button>
        <button onclick="scaleModel(1.1)">Zoom +</button>
        <button onclick="scaleModel(0.9)">Zoom -</button>
    </div>

    <script>
        const model = document.getElementById('skull-model');
        const matrixDisplay = document.getElementById('matrix-display');

        // Fonction pour mettre à jour l'affichage de la matrice du modèle
        function updateMatrixDisplay() {
            const matrix = model.object3D.matrix;
            matrixDisplay.innerHTML = `Matrice du modèle :<br>${matrix.elements.map(e => e.toFixed(2)).join(' ')}`;
        }

        // Déplacer le modèle
        function moveModel(dx, dy, dz) {
            const pos = model.object3D.position;
            pos.x += dx;
            pos.y += dy;
            pos.z += dz;
            updateMatrixDisplay();
        }

        // Tourner le modèle autour des axes X, Y, Z
        function rotateModel(rx, ry, rz) {
            model.object3D.rotation.x += THREE.Math.degToRad(rx);
            model.object3D.rotation.y += THREE.Math.degToRad(ry);
            model.object3D.rotation.z += THREE.Math.degToRad(rz);
            updateMatrixDisplay();
        }

        // Mise à l'échelle du modèle
        function scaleModel(factor) {
            model.object3D.scale.multiplyScalar(factor);
            updateMatrixDisplay();
        }

        // Mettre à jour la matrice du modèle à intervalles réguliers
        setInterval(updateMatrixDisplay, 500);
    </script>
</body>
</html>
